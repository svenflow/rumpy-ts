[package]
name = "rumpy-wasm"
description = "WASM bindings for RumPy"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true

[lib]
crate-type = ["cdylib", "rlib"]

[features]
default = ["console_error_panic_hook"]
# Enable the raw-futex GEMM dispatch (spawns its own Web Worker pool via
# wasm_thread, bypassing Rayon). Off by default: it's experimental and
# requires ES-module Workers at runtime.
#
# To build with it:
#   wasm-pack build crates/rumpy-wasm --target web --release -- --features futex-pool
futex-pool = ["pthreadpool-rs/wasm-futex", "rumpy-cpu/wasm-futex"]

[dependencies]
rumpy-core = { path = "../rumpy-core" }
rumpy-cpu = { path = "../rumpy-cpu" }
pthreadpool-rs = { path = "../pthreadpool-rs", features = ["wasm-threads"] }
ndarray.workspace = true
wasm-bindgen.workspace = true
wasm-bindgen-rayon.workspace = true
rayon.workspace = true
js-sys.workspace = true
web-sys.workspace = true
getrandom.workspace = true
serde-wasm-bindgen.workspace = true
console_error_panic_hook = { workspace = true, optional = true }

[dev-dependencies]
wasm-bindgen-test.workspace = true

[profile.release]
opt-level = 3
lto = true
